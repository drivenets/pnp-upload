"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.setup = void 0;
var common_1 = require("@pnp/common-commonjs");
(0, common_1.onRuntimeCreate)(function (runtime) {
    var existing = runtime.get("graph");
    var graphPart = Object.assign({}, {
        fetchClientFactory: function () {
            // we keep a ref to the runtime within which we are assigned
            var context = runtime.get("spfxContext");
            if ((0, common_1.objectDefinedNotNull)(context)) {
                return new common_1.SPFxAdalClient(context);
            }
            throw Error("There is no Graph Client available, either set one using configuration or provide a valid SPFx Context.");
        },
    }, existing);
    runtime.assign({ graph: graphPart });
});
function setup(config, runtime) {
    if (runtime === void 0) { runtime = common_1.DefaultRuntime; }
    runtime.assign(config);
}
exports.setup = setup;
//# sourceMappingURL=graphlibconfig.js.map